---
title: "SVM to predict AcP"
author: "Kirsten Zimbardi"
date: "26 May 2016"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, warning=F, message=F, error=F)
#clean workspace
rm(list=ls())
```

## Playing with SVM to predict academic performance

loading data...  
```{r, echo=FALSE}
#packages
require(reshape2)
require(dplyr)
require(caTools)
require(e1071)
require(neuralnet)

#functions
source("UQM functions.R")
source("HelperFunctions.R")
source("/Users/KirstenZ/Dropbox/UQ/FeedbackAnalytics/MachineLearningSandbox/HelperFunctionsMachineLearning.R")

path = "/Users/KirstenZ/Dropbox/UQ/FeedbackAnalytics/Usage paper/Analysis"
ProjectID = read.csv(paste0(path, "/Data Stage 1/ProjectIDs.csv"))
projects()

#data
folder = paste0(path, "/Data Stage 2/")
demog = uqm.csv("demog")
AcP = uqm.csv("AcPdf")
SubID.index = uqm.csv("SubIDindex")

# Don't need these yet
#FbP = uqm.csv("FbPdf")
#FbU = uqm.csv("FbUdf")
#AcPFbUbins = uqm.csv("AcPFbUbins")
#mt = uqm.csv("MarkingTimes")

#FbPsum = uqm.csv("FbPsummary") #Check GitHub repo for deleted explaination
#FbP.AcP = merge(FbPsum, AcP, by="SubmissionID")

#Generalising course names for pubilcation
demog = gen(demog, 13, 14)
AcP = gen(AcP, 7, 8)
#FbP = gen(FbP, 15, 16)
#FbU = gen(FbU, 22, 23)
#AcPFbUbins = gen(AcPFbUbins, 7, 8)
SubID.index = gen(SubID.index, 4, 5)
#mt = gen(mt, 7, 8)

```


Split data into training, cv and test sets  
```{r}
# how much data do we have
with(AcP, table(project, course))

# start with L1Sem1
L1Sem1 = subset(AcP, course == "Level 1" & sem == "Semester 1")

# pulling out lists of students for training, cv and test
studs = unique(L1Sem1$StudentID)
stud.reports = as.data.frame.matrix(with(L1Sem1, addmargins(table(StudentID, report),2)))
stud.complete = row.names(subset(stud.reports, Sum == 4))
stud.split = splitter(stud.complete, 60)

#train = stud.split[[1]]

L1Sem1.train = L1Sem1[which(L1Sem1$StudentID %in% stud.split[[1]]),]
L1Sem1.cv = L1Sem1[which(L1Sem1$StudentID %in% stud.split[[2]]),]
L1Sem1.test = L1Sem1[which(L1Sem1$StudentID %in% stud.split[[3]]),]

# to generalise to full data set
#AcP.train = AcP[which(AcP$StudentID %in% stud.split[[1]]),]

```


